#include<bits/stdc++.h>
#include<cstdlib>
#include<ctime>
using namespace std;
void welcome_user()
{
    cout<<"Welcome to Rock, Paper, Scissors!\n";
}
string get_user_input(string valid_choices[])
{
    string user_choice;

    // Print prompt once before first try
    cout << "Enter rock, paper, or scissors:\n";

    while (true)
    {
        cin >> user_choice;

        // Convert input to lowercase
        for (int i=0;i<3;i++)
        {
            user_choice[i]=tolower(user_choice[i]);
        }

        // Check if valid
        bool is_valid = false;
        for (int i = 0; i < 3; i++)
        {
            if (user_choice == valid_choices[i])
            {
                is_valid = true;
                break;
            }
        }

        if (is_valid)
        {
            return user_choice;  // valid → exit loop and return
        }

        // Invalid → show error + repeat prompt
        cout << "Oops! That's not a valid move. Please enter rock, paper, or scissors.\n";
        cout << "Enter rock, paper, or scissors:\n";
    }
}
string get_computer_choice(string valid_choices[])
{
    srand(time(0));
    return valid_choices[rand()%3];
}
string determine_winner(string user_choice,string computer_choice)
{
    if(user_choice==computer_choice)
    {
        return "Draw!";
    }
    else if(user_choice=="rock" && computer_choice=="scissors")
    {
        return "You win!";
    }
    else if(user_choice=="scissors" && computer_choice=="paper")
    {
        return "You win!";
    }
    else if(user_choice=="paper" && computer_choice=="rock")
    {
        return "You win!";
    }
    else
    {
        return "You lose!";
    }
}
int main()
{
    welcome_user();
    int player_score=0,computer_score=0;
    string user_choice,computer_choice,result,valid_choices[3]={"rock","paper","scissors"},play_again="yes";
    while(play_again!="no")
    {
        user_choice=get_user_input(valid_choices);
        cout<<"You chose: "<<user_choice;
        computer_choice=get_computer_choice(valid_choices);
        cout<<"\nComputer chose: "<<computer_choice<<endl;
        result=determine_winner(user_choice,computer_choice);
        cout<<result;
        if(result=="You win!")
        {
            player_score+=1;
        }
        else if(result=="You lose!")
        {
            computer_score+=1;
        }
        cout<<"Do you want to play again? (yes/no): ";
        cin>>play_again;
    }
    cout<<"Your score: "<<player_score<<endl;
    cout<<"Computer score: "<<computer_score<<endl;
    cout<<"Thank you for playing";
    return 0;
}
